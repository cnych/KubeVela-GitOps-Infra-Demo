apiVersion: v1
kind: Secret
metadata:
  name: mysql-secret
type: Opaque
data:
  ROOT_PASSWORD: cm9vdDMyMQo=
---
apiVersion: core.oam.dev/v1beta1
kind: Application
metadata:
  name: mysql
  namespace: default
spec:
  components:
    - name: mysql-operator
      type: helm
      properties:
        repoType: helm
        url: https://helm-charts.bitpoke.io
        chart: mysql-operator
        version: "v0.7.0"
        values:
          image: gcr.io/pl-infra/db-operator:latest
          orchestrator.image: gcr.io/pl-infra/db-operator-orchestrator:latest
    - name: mysql-cluster
      type: raw
      dependsOn:
        - mysql-operator
      properties:
        apiVersion: mysql.presslabs.org/v1alpha1
        kind: MysqlCluster
        metadata:
          name: mysql-cluster
        spec:
          replicas: 1
          secretName: mysql-secret
